# ì•„ì›ƒê²Œì„ ì•„í‚¤í…ì²˜ 1ì°¨ ì™„ì„± ë§ˆì¼ìŠ¤í†¤

## ê°œìš”

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ë§ˆì¼ìŠ¤í†¤ ID** | OUTGAME-V1 |
| **ëª©í‘œ** | ì•„ì›ƒê²Œì„ í•µì‹¬ ê¸°ëŠ¥ ê¸°ì´ˆ í† ëŒ€ ì™„ì„± |
| **ë²”ìœ„** | ê°€ì± , ìƒì , ìºë¦­í„°ë¦¬ìŠ¤íŠ¸, ìŠ¤í…Œì´ì§€ì§„ì…, ì´ë²¤íŠ¸ì§„ì… |
| **ì‹œì‘ì¼** | 2026-01-17 |
| **ìƒíƒœ** | ğŸ”¨ ì§„í–‰ ì¤‘ |

---

## ëª©í‘œ ê¸°ëŠ¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      [Lobby Screen]                          â”‚
â”‚                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  ê°€ì±     â”‚  â”‚  ìƒì     â”‚  â”‚ ìºë¦­í„°   â”‚  â”‚ ìŠ¤í…Œì´ì§€ â”‚   â”‚
â”‚   â”‚ (Gacha)  â”‚  â”‚ (Shop)   â”‚  â”‚ (Char)   â”‚  â”‚ (Stage)  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â”‚
â”‚        â”‚             â”‚             â”‚             â”‚          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚   â”‚ ì´ë²¤íŠ¸   â”‚                                              â”‚
â”‚   â”‚ (Event)  â”‚                                              â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚             â”‚             â”‚             â”‚
         â–¼             â–¼             â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GachaScreen  â”‚ â”‚ ShopScreen   â”‚ â”‚ CharList     â”‚ â”‚ StageList    â”‚
â”‚ GachaResult  â”‚ â”‚ PurchasePopupâ”‚ â”‚ CharDetail   â”‚ â”‚ PartySelect  â”‚
â”‚ (âœ… ì™„ë£Œ)    â”‚ â”‚ (âŒ ë¯¸êµ¬í˜„)  â”‚ â”‚ (âœ… ì™„ë£Œ)    â”‚ â”‚ (âŒ ë¯¸êµ¬í˜„)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EventDash    â”‚
â”‚ EventDetail  â”‚
â”‚ (âŒ ë¯¸êµ¬í˜„)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ê°œë°œ ì›ì¹™

### í…ŒìŠ¤íŠ¸ ê°€ëŠ¥ êµ¬ì¡°

> **í•µì‹¬**: ê° ì‹œìŠ¤í…œì„ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ê³„
> **ìƒì„¸**: [Testing/TestArchitecture.md](../Specs/Testing/TestArchitecture.md)

| ì›ì¹™ | ì„¤ëª… |
|------|------|
| **ì‹œìŠ¤í…œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸** | Phaseê°€ ì•„ë‹Œ ì‹œìŠ¤í…œ ê¸°ì¤€ (Navigation, Popup, Gacha ë“±) |
| **ì˜ì¡´ì„± ì£¼ì…** | SO + ServiceLocator í˜¼í•©, Mock êµì²´ ê°€ëŠ¥ |
| **ì—ë””í„° í…ŒìŠ¤íŠ¸** | ê° ê¸°ëŠ¥ ë…ë¦½ í…ŒìŠ¤íŠ¸ í™˜ê²½ (SystemTestRunner) |
| **ìë™í™” ì—°ë™** | ìˆ˜ë™ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ Unity Test Frameworkì™€ ê³µìœ  |

### ì˜ì¡´ì„± ê´€ë¦¬ íŒ¨í„´

```csharp
// 1. ì¸í„°í˜ì´ìŠ¤ ì •ì˜
public interface ITimeService { ... }

// 2. Inspector í• ë‹¹ ìš°ì„ , ì—†ìœ¼ë©´ ServiceLocator í´ë°±
_timeService = (_timeServiceAsset as ITimeService) ?? Services.Get<ITimeService>();

// 3. í…ŒìŠ¤íŠ¸ ì‹œ Mock ì£¼ì…
Services.Register<ITimeService>(new MockTimeService());
```

---

## Phase êµ¬ì„±

| Phase | ì´ë¦„ | í•µì‹¬ ì‚°ì¶œë¬¼ | ì˜ì¡´ì„± |
|-------|------|-------------|--------|
| **0** | Foundation | Log, ErrorCode, SaveManager, LoadingIndicator | - |
| **1** | ê³µí†µ ëª¨ë“ˆ | RewardInfo, TimeService, SystemPopup, RewardPopup | Phase 0 |
| **2** | ìƒì  | ShopScreen, PurchaseAsync | Phase 1 |
| **3** | ìŠ¤í…Œì´ì§€ ì§„ì… | StageListScreen, PartySelectScreen | Phase 1 |
| **4** | ë¼ì´ë¸Œ ì´ë²¤íŠ¸ | EventDashboard, EventDetail | Phase 1, 2 |
| **5** | ê¸°ì¡´ ê¸°ëŠ¥ ê°•í™” | ê°€ì±  ì—°ì¶œ, ìºë¦­í„° í•„í„°/ì •ë ¬ | Phase 1~4 |

### ì œì™¸ í•­ëª© (ë³„ë„ ë§ˆì¼ìŠ¤í†¤)

| ê¸°ëŠ¥ | ì´ìœ  | ì˜ˆì • ë§ˆì¼ìŠ¤í†¤ |
|------|------|---------------|
| **ì‹œì¦ŒíŒ¨ìŠ¤** | ë¯¸ì…˜ ê¸°ë°˜í˜• ì„ íƒ â†’ ë³„ë„ ì‹œìŠ¤í…œ í•„ìš” (ë³µì¡ë„ ë†’ìŒ) | PASS-V1 |

---

## Phase 0: Foundation

> **ëª©í‘œ**: ì „ì²´ ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš©í•˜ëŠ” ê¸°ë°˜ ì¸í”„ë¼ êµ¬ì¶•
> **ìƒíƒœ**: ğŸ“ ì„¤ê³„ ì™„ë£Œ

### 0.1 ë¡œê¹… ì‹œìŠ¤í…œ (Log)

**í•„ìš” ì´ìœ **: ë””ë²„ê¹…, ë¬¸ì œ ì¶”ì , ë¦´ë¦¬ì¦ˆ ë¹Œë“œ ìµœì í™”

#### ì‚°ì¶œë¬¼

| íŒŒì¼ | ìœ„ì¹˜ | ì—­í•  |
|------|------|------|
| `LogLevel.cs` | Foundation/ | ë¡œê·¸ ë ˆë²¨ enum |
| `Log.cs` | Foundation/ | ì •ì  ë¡œê¹… API |
| `ILogOutput.cs` | Foundation/ | ì¶œë ¥ ì¸í„°í˜ì´ìŠ¤ |
| `UnityLogOutput.cs` | Foundation/ | Unity ì½˜ì†” ì¶œë ¥ |
| `LogConfig.cs` | Foundation/ | ë¡œê·¸ ì„¤ì • (ScriptableObject) |

#### LogLevel ì •ì˜
```csharp
public enum LogLevel
{
    Verbose = 0,    // ìƒì„¸ ë””ë²„ê¹… (ë¦´ë¦¬ì¦ˆ ì œê±°)
    Debug = 1,      // ê°œë°œ ë””ë²„ê¹… (ë¦´ë¦¬ì¦ˆ ì œê±°)
    Info = 2,       // ì •ë³´ì„± ë¡œê·¸
    Warning = 3,    // ê²½ê³ 
    Error = 4,      // ì—ëŸ¬
    None = 5,       // ë¡œê·¸ ë”
}
```

#### Log API
```csharp
public static class Log
{
    // ê¸°ë³¸ ì‚¬ìš©
    [Conditional("ENABLE_LOG_VERBOSE")]
    public static void Verbose(string message);
    
    [Conditional("ENABLE_LOG_DEBUG"), Conditional("UNITY_EDITOR")]
    public static void Debug(string message);
    
    public static void Info(string message);
    public static void Warning(string message);
    public static void Error(string message, Exception ex = null);
    
    // ì¹´í…Œê³ ë¦¬ ì§€ì •
    public static void Info(string category, string message);
    
    // êµ¬ì¡°í™”ëœ ë¡œê·¸
    public static void Info<T>(string category, string message, T context);
}
```

### 0.2 ì—ëŸ¬ ì²˜ë¦¬ ì‹œìŠ¤í…œ (Error)

**í•„ìš” ì´ìœ **: ì¼ê´€ëœ ì—ëŸ¬ ì½”ë“œ, ëª…ì‹œì  ì—ëŸ¬ ì „íŒŒ

#### ì‚°ì¶œë¬¼

| íŒŒì¼ | ìœ„ì¹˜ | ì—­í•  |
|------|------|------|
| `ErrorCode.cs` | Foundation/ | ì—ëŸ¬ ì½”ë“œ ìƒìˆ˜ |
| `ErrorMessages.cs` | Foundation/ | ì—ëŸ¬ ë©”ì‹œì§€ ë§¤í•‘ |
| `Result.cs` | Foundation/ | Result<T> êµ¬ì¡°ì²´ |

#### ErrorCode ì²´ê³„
```csharp
public static class ErrorCode
{
    // ê³µí†µ (0xxx)
    public const string SUCCESS = "0000";
    public const string UNKNOWN = "0001";
    public const string INVALID_REQUEST = "0002";
    public const string TIMEOUT = "0003";
    public const string NETWORK_ERROR = "0004";
    
    // ì¸ì¦ (1xxx)
    public const string AUTH_FAILED = "1001";
    public const string SESSION_EXPIRED = "1002";
    
    // ìƒì  (2xxx)
    public const string SHOP_INSUFFICIENT_CURRENCY = "2001";
    public const string SHOP_LIMIT_EXCEEDED = "2002";
    public const string SHOP_PRODUCT_NOT_FOUND = "2003";
    public const string SHOP_EVENT_ENDED = "2004";
    
    // ê°€ì±  (3xxx)
    public const string GACHA_NOT_ENOUGH_CURRENCY = "3001";
    public const string GACHA_POOL_NOT_FOUND = "3002";
    
    // ìŠ¤í…Œì´ì§€ (4xxx)
    public const string STAGE_NOT_UNLOCKED = "4001";
    public const string STAGE_STAMINA_NOT_ENOUGH = "4002";
    
    // ë°ì´í„° (5xxx)
    public const string DATA_SAVE_FAILED = "5001";
    public const string DATA_LOAD_FAILED = "5002";
    public const string DATA_MIGRATION_FAILED = "5003";
    public const string DATA_CORRUPTED = "5004";
}
```

#### Result<T> íŒ¨í„´
```csharp
public readonly struct Result<T>
{
    public bool IsSuccess { get; }
    public bool IsFailure => !IsSuccess;
    public T Value { get; }
    public string ErrorCode { get; }
    
    public static Result<T> Success(T value);
    public static Result<T> Failure(string errorCode);
    
    public Result<U> Map<U>(Func<T, U> mapper);
    public Result<T> OnSuccess(Action<T> action);
    public Result<T> OnFailure(Action<string> action);
}
```

### 0.3 ì„¸ì´ë¸Œ ì‹œìŠ¤í…œ (Save)

**í•„ìš” ì´ìœ **: ì•ˆì „í•œ ì €ì¥/ë¡œë“œ, ë²„ì „ ë§ˆì´ê·¸ë ˆì´ì…˜

#### ì‚°ì¶œë¬¼

| íŒŒì¼ | ìœ„ì¹˜ | ì—­í•  |
|------|------|------|
| `ISaveStorage.cs` | Core/Interfaces/ | ì €ì¥ì†Œ ì¸í„°í˜ì´ìŠ¤ |
| `FileSaveStorage.cs` | Core/Services/ | íŒŒì¼ ê¸°ë°˜ ì €ì¥ì†Œ |
| `SaveManager.cs` | Core/Managers/ | ì €ì¥/ë¡œë“œ ê´€ë¦¬ |
| `ISaveMigration.cs` | Core/Interfaces/ | ë§ˆì´ê·¸ë ˆì´ì…˜ ì¸í„°í˜ì´ìŠ¤ |
| `SaveMigrator.cs` | Core/Services/ | ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰ |

#### SaveManager API
```csharp
public class SaveManager : Singleton<SaveManager>
{
    public int CurrentVersion { get; }
    
    // ì €ì¥/ë¡œë“œ
    public Result<bool> Save(UserSaveData data);
    public Result<UserSaveData> Load();
    
    // ë§ˆì´ê·¸ë ˆì´ì…˜
    public bool NeedsMigration(UserSaveData data);
    public UserSaveData Migrate(UserSaveData data);
    
    // ìë™ ì €ì¥
    public void EnableAutoSave(float intervalSeconds);
    public void DisableAutoSave();
}
```

#### ë§ˆì´ê·¸ë ˆì´ì…˜ ì²´ì¸
```csharp
public interface ISaveMigration
{
    int FromVersion { get; }
    int ToVersion { get; }
    UserSaveData Migrate(UserSaveData data);
}
```

### 0.4 ë¡œë”© UI (LoadingIndicator)

**í•„ìš” ì´ìœ **: ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ì¤‘ í™”ë©´ ì°¨ë‹¨, UX ê°œì„ 

#### ì‚°ì¶œë¬¼

| íŒŒì¼ | ìœ„ì¹˜ | ì—­í•  |
|------|------|------|
| `LoadingIndicator.cs` | Common/UI/ | ë¡œë”© ê´€ë¦¬ (ì‹±ê¸€í†¤) |
| `LoadingWidget.cs` | Common/UI/Widgets/ | ë¡œë”© UI ìœ„ì ¯ |

#### LoadingIndicator API
```csharp
public class LoadingIndicator : Singleton<LoadingIndicator>
{
    // ê¸°ë³¸ ì‚¬ìš©
    public void Show();
    public void Hide();
    
    // ë©”ì‹œì§€ í¬í•¨
    public void Show(string message);
    
    // íƒ€ì„ì•„ì›ƒ ìë™ í•´ì œ
    public void Show(float timeoutSeconds);
    
    // ìŠ¤ì½”í”„ ê¸°ë°˜ (using íŒ¨í„´)
    public IDisposable Scope(string message = null);
}
```

#### ì‚¬ìš© ì˜ˆì‹œ
```csharp
// using íŒ¨í„´
using (LoadingIndicator.Instance.Scope("êµ¬ë§¤ ì¤‘..."))
{
    var response = await _apiClient.PurchaseAsync(request);
}
// ìë™ Hide

// ìˆ˜ë™ ì œì–´
LoadingIndicator.Instance.Show();
try { ... }
finally { LoadingIndicator.Instance.Hide(); }
```

### 0.5 ì²´í¬ë¦¬ìŠ¤íŠ¸

```
Phase 0 ì²´í¬ë¦¬ìŠ¤íŠ¸:

ë¡œê¹… ì‹œìŠ¤í…œ:
- [ ] LogLevel.cs ìƒì„±
- [ ] Log.cs ìƒì„± (ì •ì  API)
- [ ] ILogOutput.cs ìƒì„±
- [ ] UnityLogOutput.cs ìƒì„±
- [ ] LogConfig.cs ìƒì„± (ScriptableObject)
- [ ] ì—ë””í„° ë¡œê·¸ í•„í„° UI (ì„ íƒ)

ì—ëŸ¬ ì²˜ë¦¬:
- [ ] ErrorCode.cs ìƒì„±
- [ ] ErrorMessages.cs ìƒì„±
- [ ] Result.cs ìƒì„±

ì„¸ì´ë¸Œ ì‹œìŠ¤í…œ:
- [ ] ISaveStorage.cs ìƒì„±
- [ ] FileSaveStorage.cs ìƒì„±
- [ ] SaveManager.cs ìƒì„±
- [ ] ISaveMigration.cs ìƒì„±
- [ ] SaveMigrator.cs ìƒì„±
- [ ] UserSaveDataì— Version í•„ë“œ ì¶”ê°€

ë¡œë”© UI:
- [ ] LoadingIndicator.cs ìƒì„±
- [ ] LoadingWidget.cs ìƒì„±
- [ ] Loading í”„ë¦¬íŒ¹ ìƒì„±
- [ ] MVPSceneSetupì— LoadingIndicator ì¶”ê°€
```

---

## Phase 1: ê³µí†µ ëª¨ë“ˆ

> **ëª©í‘œ**: ì—¬ëŸ¬ ê¸°ëŠ¥ì—ì„œ ê³µìœ í•˜ëŠ” ê¸°ë°˜ êµ¬ì¡° êµ¬ì¶•
> **ìƒíƒœ**: âœ… ì„¤ê³„ ì™„ë£Œ

### 1.1 ë³´ìƒ ì‹œìŠ¤í…œ (Reward)

**í•„ìš” ì´ìœ **: ê°€ì± , ìƒì , ìŠ¤í…Œì´ì§€, ì´ë²¤íŠ¸ ëª¨ë‘ "ë³´ìƒ ì§€ê¸‰" í•„ìš”

#### ì‚°ì¶œë¬¼

| íŒŒì¼ | ìœ„ì¹˜ | ì—­í•  |
|------|------|------|
| `RewardType.cs` | Data/Enums/ | ë³´ìƒ íƒ€ì… ì—´ê±°í˜• (4ê°œ) |
| `ItemCategory.cs` | Data/Enums/ | ì•„ì´í…œ ì„¸ë¶€ ë¶„ë¥˜ (6ê°œ) |
| `RewardInfo.cs` | Data/Structs/Common/ | ë³´ìƒ ì •ë³´ êµ¬ì¡°ì²´ |
| `RewardHelper.cs` | Core/Utility/ | UI í—¬í¼ (í¬ë§·íŒ…, ì•„ì´ì½˜) |

#### RewardType ì •ì˜ (í™•ì •)
```csharp
public enum RewardType
{
    Currency,       // ì¬í™” (ê³¨ë“œ, ì ¬, ìŠ¤íƒœë¯¸ë‚˜, ì´ë²¤íŠ¸ ì½”ì¸)
    Item,           // ëª¨ë“  ì¸ë²¤í† ë¦¬ ì•„ì´í…œ
    Character,      // ìºë¦­í„° íšë“
    PlayerExp,      // í”Œë ˆì´ì–´ ê²½í—˜ì¹˜
}

public enum ItemCategory
{
    Equipment,      // ì¥ë¹„ (ì¥ì°© ì „, ìˆ˜ëŸ‰ ê¸°ë°˜)
    Consumable,     // ì†Œëª¨í’ˆ (ê²½í—˜ì¹˜ ì•„ì´í…œ, ë²„í”„ ë“±)
    Material,       // ì¬ë£Œ (ê°•í™”, ì§„í™”, ëŒíŒŒ)
    CharacterShard, // ìºë¦­í„° ì¡°ê°
    Furniture,      // ê°€êµ¬
    Ticket,         // ì†Œí™˜ í‹°ì¼“
}
```

#### RewardInfo êµ¬ì¡°ì²´ (í™•ì •)
```csharp
[Serializable]
public struct RewardInfo
{
    public RewardType Type;
    public string ItemId;
    public int Amount;
}
```

#### RewardHelper ì—­í•  (í´ë¼ì´ì–¸íŠ¸)
- `FormatText(RewardInfo)` â†’ UI í‘œì‹œìš© í…ìŠ¤íŠ¸
- `GetIconPath(RewardInfo)` â†’ ì•„ì´ì½˜ ê²½ë¡œ
- `GetRarityColor(RewardInfo)` â†’ í¬ê·€ë„ ìƒ‰ìƒ

### 1.2 ì„œë²„/í´ë¼ì´ì–¸íŠ¸ ë¶„ë¦¬ (Sc.LocalServer)

**í•„ìš” ì´ìœ **: ì„œë²„ ë¡œì§ê³¼ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ ëª…í™• ë¶„ë¦¬

#### ìƒˆ Assembly êµ¬ì¡°
```
Sc.LocalServer (ì„œë²„ ëª¨ì‚¬ ì˜ì—­)
â”œâ”€â”€ LocalGameServer.cs
â”œâ”€â”€ Handlers/
â”‚   â”œâ”€â”€ LoginHandler.cs
â”‚   â”œâ”€â”€ GachaHandler.cs
â”‚   â”œâ”€â”€ ShopHandler.cs
â”‚   â””â”€â”€ StageHandler.cs
â”œâ”€â”€ Validators/
â”‚   â””â”€â”€ ServerValidator.cs
â””â”€â”€ Services/
    â”œâ”€â”€ RewardService.cs    # Delta ìƒì„±
    â””â”€â”€ GachaService.cs

Sc.Core (í´ë¼ì´ì–¸íŠ¸)
â”œâ”€â”€ ResponseValidator.cs    # 2ì°¨ ê²€ì¦ (ìš”ì²­-ì‘ë‹µ ì¼ê´€ì„±)
â””â”€â”€ Utility/
    â””â”€â”€ RewardHelper.cs
```

### 1.3 ë²”ìš© íŒì—… (SystemPopup)

**í•„ìš” ì´ìœ **: í™•ì¸, ì•Œë¦¼, ì…ë ¥, ì¬í™” ì†Œë¹„ ë“± ê³µí†µ UI íŒ¨í„´

#### ì‚°ì¶œë¬¼ (í•˜ì´ë¸Œë¦¬ë“œ êµ¬ì¡°)

| íŒŒì¼ | ìœ„ì¹˜ | ì—­í•  |
|------|------|------|
| `SystemPopupBase.cs` | Common/UI/Popups/ | ì¶”ìƒ ë² ì´ìŠ¤ |
| `ConfirmPopup.cs` | Common/UI/Popups/ | í™•ì¸/ì·¨ì†Œ íŒì—… |
| `AlertPopup.cs` | Common/UI/Popups/ | ì•Œë¦¼ íŒì—… (Info/Warning/Error) |
| `InputPopup.cs` | Common/UI/Popups/ | í…ìŠ¤íŠ¸ ì…ë ¥ íŒì—… |
| `CostConfirmPopup.cs` | Common/UI/Popups/ | ì¬í™” ì†Œë¹„ í™•ì¸ íŒì—… |
| `ButtonStyle.cs` | Common/UI/Popups/ | ë²„íŠ¼ ìŠ¤íƒ€ì¼ (Default/Primary/Danger/Secondary) |

### 1.4 ë³´ìƒ íŒì—… (RewardPopup)

**í•„ìš” ì´ìœ **: ë³´ìƒ íšë“ ì‹œ ì‹œê°ì  í‘œì‹œ

#### ì‚°ì¶œë¬¼ (ì¢Œìš° ìŠ¤í¬ë¡¤ ì¹´ë“œí˜•)

| íŒŒì¼ | ìœ„ì¹˜ | ì—­í•  |
|------|------|------|
| `RewardPopup.cs` | Common/UI/Popups/ | ë©”ì¸ (ì¢Œìš° ìŠ¤í¬ë¡¤) |
| `RewardFullViewPopup.cs` | Common/UI/Popups/ | ì „ì²´ ë³´ê¸° (ê·¸ë¦¬ë“œ) |
| `RewardCard.cs` | Common/UI/Popups/ | ê°œë³„ ì¹´ë“œ ìœ„ì ¯ |

#### ë ˆì´ì•„ì›ƒ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              íšë“ ë³´ìƒ (3/7)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â—€    â”‚   [ì¹´ë“œ ë‚´ìš©]       â”‚    â–¶    â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚              â— â—‹ â—‹ â—‹ â—‹ â—‹ â—‹              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      [ì „ì²´ ë³´ê¸°]       [í™•ì¸]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ì •ë ¬/í‘œì‹œ ê·œì¹™
- ì •ë ¬: í¬ê·€ë„ ìˆœ (ìºë¦­í„° > ì¥ë¹„ > ì¬ë£Œ > ì¬í™”)
- ì „ì²´ ë³´ê¸°: 4ì—´ ê·¸ë¦¬ë“œ ì„œë¸Œ íŒì—…
- ì‹ ê·œ ì•„ì´í…œ: NEW ë±ƒì§€ + ê¸ˆìƒ‰ í”„ë ˆì„

### 1.5 ì‹œê°„ ì²˜ë¦¬ (TimeService)

**í•„ìš” ì´ìœ **: êµ¬ë§¤ ì œí•œ, ì´ë²¤íŠ¸, ì¶œì„ ë“± ì—¬ëŸ¬ ì‹œìŠ¤í…œì—ì„œ ì‹œê°„ ê¸°ë°˜ ë¡œì§ í•„ìš”

#### ì„¤ê³„ ì›ì¹™
- **ì €ì¥/ê³„ì‚°**: í•­ìƒ UTC (Unix timestamp)
- **UI í‘œì‹œ**: ë¡œì»¬ ì‹œê°„ ë³€í™˜
- **ë¦¬ì…‹ ê¸°ì¤€**: UTC 0ì‹œ

#### ì‚°ì¶œë¬¼

| íŒŒì¼ | ìœ„ì¹˜ | ì—­í•  |
|------|------|------|
| `ITimeService.cs` | Core/Interfaces/ | ì‹œê°„ ì„œë¹„ìŠ¤ ì¸í„°í˜ì´ìŠ¤ |
| `TimeService.cs` | Core/Services/ | í´ë¼ì´ì–¸íŠ¸ ì‹œê°„ ì„œë¹„ìŠ¤ |
| `ServerTimeService.cs` | LocalServer/Services/ | ì„œë²„ ì‹œê°„ ì„œë¹„ìŠ¤ |
| `TimeHelper.cs` | Core/Utility/ | UI í‘œì‹œìš© í—¬í¼ |

#### ITimeService ì¸í„°í˜ì´ìŠ¤
```csharp
public interface ITimeService
{
    // í˜„ì¬ ì„œë²„ ì‹œê°„ (UTC, Unix timestamp)
    long ServerTimeUtc { get; }
    DateTime ServerDateTime { get; }
    
    // ë¦¬ì…‹ ì‹œê°„ ê³„ì‚°
    long GetNextResetTime(LimitType limitType);
    
    // ë¦¬ì…‹ ì—¬ë¶€ ì²´í¬
    bool HasResetOccurred(long lastTimestamp, LimitType limitType);
    
    // ì´ë²¤íŠ¸ ê¸°ê°„ ì²´í¬
    bool IsWithinPeriod(long startTime, long endTime);
}
```

#### TimeHelper (UI í‘œì‹œ)
```csharp
public static class TimeHelper
{
    // UTC â†’ ë¡œì»¬ ì‹œê°„ ë¬¸ìì—´
    public static string ToLocalTimeString(long utcTimestamp, string format = "yyyy-MM-dd HH:mm");
    
    // ë‚¨ì€ ì‹œê°„ í‘œì‹œ (ì˜ˆ: "2ì‹œê°„ 30ë¶„", "1ì¼ 5ì‹œê°„")
    public static string FormatRemainingTime(long targetUtcTimestamp);
    
    // ë¦¬ì…‹ê¹Œì§€ ë‚¨ì€ ì‹œê°„
    public static string FormatTimeUntilReset(LimitType limitType, ITimeService timeService);
}
```

#### ë¦¬ì…‹ ì‹œê°„ ê·œì¹™
| LimitType | ë¦¬ì…‹ ì‹œì  |
|-----------|----------|
| Daily | ë§¤ì¼ UTC 00:00 |
| Weekly | ë§¤ì£¼ ì›”ìš”ì¼ UTC 00:00 |
| Monthly | ë§¤ì›” 1ì¼ UTC 00:00 |
| Permanent | ë¦¬ì…‹ ì—†ìŒ |
| EventPeriod | ì´ë²¤íŠ¸ ì¢…ë£Œ ì‹œ (ë³„ë„ ê´€ë¦¬) |

### 1.6 ì²´í¬ë¦¬ìŠ¤íŠ¸

```
Phase 1 ì²´í¬ë¦¬ìŠ¤íŠ¸:

ë³´ìƒ ì‹œìŠ¤í…œ:
- [ ] RewardType.cs ìƒì„±
- [ ] ItemCategory.cs ìƒì„±
- [ ] RewardInfo.cs ìƒì„±
- [ ] RewardHelper.cs ìƒì„±

ì„œë²„/í´ë¼ ë¶„ë¦¬:
- [ ] Sc.LocalServer Assembly ìƒì„±
- [ ] LocalGameServer.cs ìƒì„±
- [ ] RewardService.cs ìƒì„± (Delta ìƒì„±)
- [ ] ResponseValidator.cs ìƒì„± (2ì°¨ ê²€ì¦)
- [ ] ê¸°ì¡´ LocalApiClient ë¦¬íŒ©í† ë§

ì‹œê°„ ì²˜ë¦¬:
- [ ] ITimeService.cs ìƒì„±
- [ ] TimeService.cs ìƒì„± (í´ë¼ì´ì–¸íŠ¸)
- [ ] ServerTimeService.cs ìƒì„± (Sc.LocalServer)
- [ ] TimeHelper.cs ìƒì„± (UI í‘œì‹œ)

ì‹œìŠ¤í…œ íŒì—…:
- [ ] SystemPopupBase.cs ìƒì„±
- [ ] ButtonStyle.cs ìƒì„±
- [ ] ConfirmPopup.cs ìƒì„±
- [ ] AlertPopup.cs ìƒì„±
- [ ] InputPopup.cs ìƒì„±
- [ ] CostConfirmPopup.cs ìƒì„±

ë³´ìƒ íŒì—…:
- [ ] RewardCard.cs ìƒì„±
- [ ] RewardPopup.cs ìƒì„±
- [ ] RewardFullViewPopup.cs ìƒì„±

í”„ë¦¬íŒ¹/ì”¬:
- [ ] MVPSceneSetupì— íŒì—… í”„ë¦¬íŒ¹ ì¶”ê°€
- [ ] ê° íŒì—…ë³„ í”„ë¦¬íŒ¹ ìƒì„±
```

### 1.7 ìƒì„¸ ìŠ¤í™ ë¬¸ì„œ
- [Reward.md](../Specs/Common/Reward.md)
- [SystemPopup.md](../Specs/Common/Popups/SystemPopup.md)
- [RewardPopup.md](../Specs/Common/Popups/RewardPopup.md)

---

## Phase 2: ìƒì  (Shop)

> **ëª©í‘œ**: ì¬í™” ì†Œë¹„ â†’ ìƒí’ˆ êµ¬ë§¤ â†’ ë³´ìƒ íšë“ íë¦„ ì™„ì„±
> **ìƒíƒœ**: ğŸ“ ì„¤ê³„ ê²€í†  ì¤‘

### 2.1 ë§ˆìŠ¤í„° ë°ì´í„°

#### ì‚°ì¶œë¬¼

| íŒŒì¼ | ìœ„ì¹˜ | ì—­í•  |
|------|------|------|
| `ProductType.cs` | Data/Enums/ | ìƒí’ˆ íƒ€ì… ì—´ê±°í˜• |
| `LimitType.cs` | Data/Enums/ | êµ¬ë§¤ ì œí•œ íƒ€ì… |
| `CurrencyIds.cs` | Data/Constants/ | ì¬í™” ID ìƒìˆ˜ |
| `ShopProductData.cs` | Data/ScriptableObjects/ | ìƒí’ˆ SO ì •ì˜ |
| `ShopProductDatabase.cs` | Data/ScriptableObjects/ | ìƒí’ˆ DB |
| `ShopProduct.json` | Data/MasterData/ | ìƒ˜í”Œ ë°ì´í„° |

#### ProductType ì •ì˜
```csharp
public enum ProductType
{
    Currency,   // ì¬í™” êµí™˜ (ì ¬ â†’ ê³¨ë“œ)
    Item,       // ë‹¨ì¼ ì•„ì´í…œ (ì¥ë¹„, ì¬ë£Œ, ì¡°ê°, í‹°ì¼“ ë“± - ItemCategoryë¡œ êµ¬ë¶„)
    Package,    // ë³µí•© íŒ¨í‚¤ì§€ (ì—¬ëŸ¬ ì•„ì´í…œ ë¬¶ìŒ)
    Character,  // ìºë¦­í„° ì§ì ‘ íŒë§¤ (ìŠ¤í‚¨ í¬í•¨)
}
```

#### ì†Œë¹„ ì¬í™” (CostCurrencyId)

> CostType enum ëŒ€ì‹  **string Id** ì‚¬ìš© (ì´ë²¤íŠ¸ë§ˆë‹¤ ë‹¤ë¥¸ ì½”ì¸ ëŒ€ì‘)

```csharp
// ì˜ˆì•½ëœ CurrencyId
public static class CurrencyIds
{
    public const string Free = "";           // ë¬´ë£Œ (ë¹ˆ ë¬¸ìì—´)
    public const string Gold = "gold";
    public const string Gem = "gem";
    public const string Stamina = "stamina";
    // ì´ë²¤íŠ¸ ì½”ì¸: "event_{eventId}_coin" í˜•ì‹
}
```

#### LimitType ì •ì˜
```csharp
public enum LimitType
{
    None,           // ë¬´ì œí•œ
    Daily,          // ì¼ì¼ (ë§¤ì¼ UTC 0ì‹œ ë¦¬ì…‹)
    Weekly,         // ì£¼ê°„ (ë§¤ì£¼ ì›”ìš”ì¼ UTC 0ì‹œ)
    Monthly,        // ì›”ê°„ (ë§¤ì›” 1ì¼ UTC 0ì‹œ)
    Permanent,      // ì˜êµ¬ (ê³„ì •ë‹¹ 1íšŒ, ë¦¬ì…‹ ì—†ìŒ)
    EventPeriod,    // ì´ë²¤íŠ¸ ê¸°ê°„ (ì´ë²¤íŠ¸ ì¢…ë£Œ ì‹œ ë¦¬ì…‹)
}
```

#### ShopProductData í•„ë“œ
```csharp
[CreateAssetMenu]
public class ShopProductData : ScriptableObject
{
    public string Id;
    public string Name;
    public string Description;
    public ProductType ProductType;
    public string CostCurrencyId;       // "" = ë¬´ë£Œ, "gold", "gem", "event_xxx_coin"
    public int Price;
    public RewardInfo[] Rewards;        // Phase 1ì˜ RewardInfo ì‚¬ìš©
    public LimitType LimitType;
    public int LimitCount;
    public int DisplayOrder;
    public string IconPath;
    public bool IsHot;
    public bool IsNew;
}
```

### 2.2 ìœ ì € ë°ì´í„°

#### UserSaveData í™•ì¥
```csharp
// UserSaveData.csì— ì¶”ê°€
public List<ShopPurchaseRecord> ShopPurchaseHistory;

[Serializable]
public struct ShopPurchaseRecord
{
    public string ProductId;
    public int PurchaseCount;
    public long LastPurchaseAt;     // ë§ˆì§€ë§‰ êµ¬ë§¤ ì‹œê° (UTC timestamp)
    // ResetAt ì œê±° â†’ TimeService.HasResetOccurred()ë¡œ íŒë‹¨
}
```

> **ë¦¬ì…‹ íŒë‹¨ ë¡œì§**: `TimeService.HasResetOccurred(record.LastPurchaseAt, product.LimitType)`

### 2.3 Request/Response

#### ShopPurchaseRequest
```csharp
[Serializable]
public struct ShopPurchaseRequest : IRequest
{
    public string ProductId;
    public int Amount;              // êµ¬ë§¤ ìˆ˜ëŸ‰ (ê¸°ë³¸ 1)
    public long Timestamp { get; set; }
}
```

#### ShopPurchaseResponse
```csharp
[Serializable]
public struct ShopPurchaseResponse : IResponse, IGameActionResponse
{
    public bool IsSuccess { get; set; }
    public string ErrorCode { get; set; }
    public long ServerTime { get; set; }
    public UserDataDelta Delta { get; set; }
    public RewardInfo[] Rewards;    // íšë“ ë³´ìƒ ëª©ë¡
}
```

### 2.4 ì´ë²¤íŠ¸

#### ShopEvents.cs
```csharp
public struct ProductPurchasedEvent
{
    public string ProductId;
    public RewardInfo[] Rewards;
}

public struct PurchaseFailedEvent
{
    public string ProductId;
    public string ErrorCode;
}
```

### 2.5 ì„œë²„ ë¡œì§ (Sc.LocalServer)

> Phase 1ì—ì„œ í™•ì •ëœ Sc.LocalServer êµ¬ì¡° í™œìš©

#### ShopHandler.cs (Sc.LocalServer/Handlers/)
```csharp
public class ShopHandler
{
    public ShopPurchaseResponse HandlePurchase(ShopPurchaseRequest request, UserSaveData userData)
    {
        // 1. ìƒí’ˆ ì¡°íšŒ
        // 2. êµ¬ë§¤ ì œí•œ ê²€ì¦
        // 3. ì¬í™” ê²€ì¦ (CostType, Price)
        // 4. ì¬í™” ì°¨ê°
        // 5. ë³´ìƒ ì§€ê¸‰ (RewardService í™œìš©)
        // 6. êµ¬ë§¤ ê¸°ë¡ ì €ì¥
        // 7. Delta ìƒì„± ë° ë°˜í™˜
    }
}
```

#### ShopService.cs (Sc.LocalServer/Services/)
```csharp
public class ShopService
{
    // êµ¬ë§¤ ì œí•œ ì²´í¬
    public bool CanPurchase(string productId, UserSaveData userData);
    
    // ë¦¬ì…‹ ì‹œê°„ ê³„ì‚°
    public long CalculateResetTime(LimitType limitType);
    
    // êµ¬ë§¤ ê¸°ë¡ ì—…ë°ì´íŠ¸
    public void UpdatePurchaseRecord(string productId, UserSaveData userData);
}
```

### 2.6 UI

#### ì‚°ì¶œë¬¼

| íŒŒì¼ | ìœ„ì¹˜ | ì—­í•  |
|------|------|------|
| `ShopScreen.cs` | Contents/OutGame/Shop/ | ìƒì  ë©”ì¸ í™”ë©´ |
| `ShopProductItem.cs` | Contents/OutGame/Shop/ | ìƒí’ˆ ì•„ì´í…œ ìœ„ì ¯ |
| `ShopTabGroup.cs` | Contents/OutGame/Shop/ | íƒ­ ê·¸ë£¹ |

> êµ¬ë§¤ í™•ì¸ì€ Phase 1ì˜ CostConfirmPopup ì¬ì‚¬ìš©

#### ShopScreen êµ¬ì¡°
```
[ShopScreen]
â”œâ”€â”€ ScreenHeader (ê³µí†µ)
â”œâ”€â”€ ShopTabGroup (ì¬í™”/ì•„ì´í…œ/íŒ¨í‚¤ì§€)
â”œâ”€â”€ ProductScrollView
â”‚   â””â”€â”€ ShopProductItem[] (ë™ì  ìƒì„±)
â””â”€â”€ CurrencyHUD (ê³µí†µ)
```

### 2.7 ì²´í¬ë¦¬ìŠ¤íŠ¸

```
Phase 2 ì²´í¬ë¦¬ìŠ¤íŠ¸:

ë§ˆìŠ¤í„° ë°ì´í„°:
- [ ] ProductType.cs ìƒì„±
- [ ] LimitType.cs ìƒì„±
- [ ] CurrencyIds.cs ìƒì„± (ì¬í™” ID ìƒìˆ˜)
- [ ] ShopProductData.cs ìƒì„±
- [ ] ShopProductDatabase.cs ìƒì„±
- [ ] ShopProduct.json ìƒ˜í”Œ ë°ì´í„°
- [ ] MasterDataImporterì— ShopProduct ì¶”ê°€

ìœ ì € ë°ì´í„°:
- [ ] ShopPurchaseRecord êµ¬ì¡°ì²´ ì¶”ê°€
- [ ] UserSaveData ë²„ì „ ë§ˆì´ê·¸ë ˆì´ì…˜

ì„œë²„ ë¡œì§ (Sc.LocalServer):
- [ ] ShopHandler.cs ìƒì„±
- [ ] ShopService.cs ìƒì„±
- [ ] LocalGameServerì— ShopHandler ë“±ë¡

Request/Response:
- [ ] ShopPurchaseRequest ìƒì„±
- [ ] ShopPurchaseResponse ìƒì„±

ì´ë²¤íŠ¸:
- [ ] ShopEvents.cs ìƒì„±

UI:
- [ ] ShopScreen.cs ìƒì„±
- [ ] ShopProductItem.cs ìƒì„±
- [ ] ShopTabGroup.cs ìƒì„±
- [ ] MVPSceneSetupì— Shop í”„ë¦¬íŒ¹ ì¶”ê°€

ì—°ë™:
- [ ] LobbyScreenì— ìƒì  ë²„íŠ¼ ì¶”ê°€
- [ ] NetworkManager ì—°ë™ í…ŒìŠ¤íŠ¸
```

### 2.8 ìƒì„¸ ìŠ¤í™ ë¬¸ì„œ
- [Shop.md](../Specs/Shop.md)
- [ShopProductData.md](../Specs/Shop/ShopProductData.md)
- [ShopScreen.md](../Specs/Shop/ShopScreen.md)

---

## Phase 3: ìŠ¤í…Œì´ì§€ ì§„ì… (Stage Entry)

> **ëª©í‘œ**: ì•„ì›ƒê²Œì„ â†’ ì¸ê²Œì„ ë¸Œë¦¿ì§€ ì™„ì„± (ì „íˆ¬ ì‹œì‘ ì§ì „ê¹Œì§€)

### 3.1 ë§ˆìŠ¤í„° ë°ì´í„° í™•ì¥

#### StageData í™•ì¥ í•„ë“œ
```csharp
// ê¸°ì¡´ StageData.csì— ì¶”ê°€
public StageType StageType;             // ìŠ¤í…Œì´ì§€ íƒ€ì…
public RewardInfo[] FirstClearRewards;  // ì´ˆíšŒ í´ë¦¬ì–´ ë³´ìƒ
public StageUnlockCondition UnlockCondition; // í•´ê¸ˆ ì¡°ê±´

[Serializable]
public struct StageUnlockCondition
{
    public string RequiredStageId;      // ì„ í–‰ ìŠ¤í…Œì´ì§€
    public int RequiredPlayerLevel;     // í•„ìš” ë ˆë²¨
}
```

#### StageType ì •ì˜
```csharp
public enum StageType
{
    Main,           // ë©”ì¸ ìŠ¤í† ë¦¬
    Daily,          // ì¼ì¼ ë˜ì „
    Weekly,         // ì£¼ê°„ ë˜ì „
    Event,          // ì´ë²¤íŠ¸ ìŠ¤í…Œì´ì§€
    Challenge,      // ì±Œë¦°ì§€
}
```

### 3.2 ìœ ì € ë°ì´í„°

#### PartyPreset ì¶”ê°€
```csharp
// UserSaveData.csì— ì¶”ê°€
public List<PartyPreset> PartyPresets;

[Serializable]
public struct PartyPreset
{
    public int SlotIndex;               // í”„ë¦¬ì…‹ ìŠ¬ë¡¯ (0~4)
    public string[] CharacterInstanceIds; // ìºë¦­í„° 4ëª…
}
```

### 3.3 Request/Response

#### StageBattleRequest
```csharp
[Serializable]
public struct StageBattleRequest : IRequest
{
    public string StageId;
    public string[] PartyCharacterIds;  // ì¶œì „ ìºë¦­í„° InstanceId ë°°ì—´
    public long Timestamp { get; set; }
}
```

#### StageBattleResponse
```csharp
[Serializable]
public struct StageBattleResponse : IResponse
{
    public bool IsSuccess { get; set; }
    public string ErrorCode { get; set; }
    public long ServerTime { get; set; }

    public string BattleId;             // ì „íˆ¬ ì„¸ì…˜ ID
    public BattleInitialData InitialData;
}

[Serializable]
public struct BattleInitialData
{
    public CharacterBattleData[] PlayerParty;
    public CharacterBattleData[] EnemyParty;
    public string[] TurnOrder;          // í–‰ë™ ìˆœì„œ
}

[Serializable]
public struct CharacterBattleData
{
    public string InstanceId;
    public string CharacterId;
    public int Level;
    public int CurrentHp;
    public int MaxHp;
    public int Atk;
    public int Def;
    public int Spd;
    public string[] SkillIds;
}
```

### 3.4 ì´ë²¤íŠ¸

#### StageEvents.cs
```csharp
public struct StageSelectedEvent
{
    public string StageId;
}

public struct BattleStartRequestedEvent
{
    public string StageId;
    public string[] PartyCharacterIds;
}

public struct BattleReadyEvent
{
    public string BattleId;
    public BattleInitialData InitialData;
}
```

### 3.5 API êµ¬í˜„

#### LocalApiClient í™•ì¥
```csharp
public async UniTask<StageBattleResponse> StartBattleAsync(StageBattleRequest request)
{
    // 1. ìŠ¤í…Œì´ì§€ ì¡°íšŒ
    // 2. í•´ê¸ˆ ì¡°ê±´ ê²€ì¦
    // 3. ìŠ¤íƒœë¯¸ë‚˜ ê²€ì¦ ë° ì°¨ê°
    // 4. íŒŒí‹° ê²€ì¦ (4ëª…, ë³´ìœ  ì—¬ë¶€)
    // 5. ì  íŒŒí‹° ìƒì„±
    // 6. ì „íˆ¬ ì´ˆê¸° ë°ì´í„° ìƒì„±
    // 7. BattleId ë°œê¸‰
    // 8. ì‘ë‹µ ë°˜í™˜
}
```

### 3.6 UI

#### ì‚°ì¶œë¬¼

| íŒŒì¼ | ìœ„ì¹˜ | ì—­í•  |
|------|------|------|
| `StageListScreen.cs` | Contents/OutGame/Stage/ | ìŠ¤í…Œì´ì§€ ì„ íƒ í™”ë©´ |
| `StageItem.cs` | Contents/OutGame/Stage/ | ìŠ¤í…Œì´ì§€ ì•„ì´í…œ ìœ„ì ¯ |
| `StageInfoPopup.cs` | Contents/OutGame/Stage/ | ìŠ¤í…Œì´ì§€ ì •ë³´ íŒì—… |
| `PartySelectScreen.cs` | Contents/OutGame/Stage/ | íŒŒí‹° í¸ì„± í™”ë©´ |
| `PartySlotWidget.cs` | Contents/OutGame/Stage/ | íŒŒí‹° ìŠ¬ë¡¯ ìœ„ì ¯ |

#### StageListScreen êµ¬ì¡°
```
[StageListScreen]
â”œâ”€â”€ ScreenHeader
â”œâ”€â”€ ChapterTabGroup
â”œâ”€â”€ StageScrollView
â”‚   â””â”€â”€ StageItem[] (ë™ì  ìƒì„±)
â”‚       â”œâ”€â”€ StageName
â”‚       â”œâ”€â”€ Stars (0~3)
â”‚       â””â”€â”€ LockIcon
â””â”€â”€ SelectedStageInfo
    â”œâ”€â”€ StageName
    â”œâ”€â”€ RecommendedPower
    â”œâ”€â”€ Rewards Preview
    â””â”€â”€ [ì¶œì „í•˜ê¸°] ë²„íŠ¼
```

#### PartySelectScreen êµ¬ì¡°
```
[PartySelectScreen]
â”œâ”€â”€ ScreenHeader
â”œâ”€â”€ StageInfoHeader
â”‚   â”œâ”€â”€ StageName
â”‚   â””â”€â”€ RecommendedPower
â”œâ”€â”€ PartySlots (4ê°œ)
â”‚   â””â”€â”€ PartySlotWidget
â”‚       â”œâ”€â”€ CharacterIcon
â”‚       â”œâ”€â”€ Level
â”‚       â””â”€â”€ [X] ì œê±° ë²„íŠ¼
â”œâ”€â”€ CharacterScrollView
â”‚   â””â”€â”€ SelectableCharacterItem[]
â”œâ”€â”€ TotalPowerDisplay
â””â”€â”€ [ì „íˆ¬ ì‹œì‘] ë²„íŠ¼
```

### 3.7 ì²´í¬ë¦¬ìŠ¤íŠ¸

```
Phase 3 ì²´í¬ë¦¬ìŠ¤íŠ¸:

ë§ˆìŠ¤í„° ë°ì´í„°:
- [ ] StageType.cs ìƒì„±
- [ ] StageUnlockCondition êµ¬ì¡°ì²´ ì¶”ê°€
- [ ] StageData.cs í™•ì¥ (FirstClearRewards, StageType, UnlockCondition)
- [ ] Stage.json ìƒ˜í”Œ ë°ì´í„° ì—…ë°ì´íŠ¸

ìœ ì € ë°ì´í„°:
- [ ] PartyPreset êµ¬ì¡°ì²´ ì¶”ê°€
- [ ] UserSaveDataì— PartyPresets í•„ë“œ ì¶”ê°€
- [ ] StageProgress í™•ì¥ (ë³„ì  ì €ì¥ êµ¬ì¡° ê°œì„ )

Request/Response:
- [ ] StageBattleRequest.cs ìƒì„±
- [ ] StageBattleResponse.cs ìƒì„±
- [ ] BattleInitialData.cs ìƒì„±
- [ ] CharacterBattleData.cs ìƒì„±

API:
- [ ] LocalApiClient.StartBattleAsync êµ¬í˜„
- [ ] ìŠ¤íƒœë¯¸ë‚˜ ì°¨ê° ë¡œì§
- [ ] ì  íŒŒí‹° ìƒì„± ë¡œì§

ì´ë²¤íŠ¸:
- [ ] StageEvents.cs ìƒì„±

UI:
- [ ] Sc.Contents.Stage Assembly ìƒì„±
- [ ] StageListScreen.cs ìƒì„±
- [ ] StageItem.cs ìƒì„±
- [ ] StageInfoPopup.cs ìƒì„±
- [ ] PartySelectScreen.cs ìƒì„±
- [ ] PartySlotWidget.cs ìƒì„±
- [ ] SelectableCharacterItem.cs ìƒì„±
- [ ] MVPSceneSetupì— Stage í”„ë¦¬íŒ¹ ì¶”ê°€

ì—°ë™:
- [ ] LobbyScreenì— ìŠ¤í…Œì´ì§€ ë²„íŠ¼ ì¶”ê°€
- [ ] NetworkManager ì—°ë™
- [ ] Battle ì‹œìŠ¤í…œ ì§„ì… ì´ë²¤íŠ¸ ì—°ê²° (Phase 5+)
```

### 3.8 ìƒì„¸ ìŠ¤í™ ë¬¸ì„œ
- [Stage.md](../Specs/Stage.md)
- [StageListScreen.md](../Specs/Stage/StageListScreen.md)
- [PartySelectScreen.md](../Specs/Stage/PartySelectScreen.md)

---

## Phase 4: ë¼ì´ë¸Œ ì´ë²¤íŠ¸ (LiveEvent)

> **ëª©í‘œ**: ê¸°ê°„ì œ ì»¨í…ì¸  ì»¨í…Œì´ë„ˆ êµ¬ì¶•

### 4.1 ë§ˆìŠ¤í„° ë°ì´í„°

#### ì‚°ì¶œë¬¼

| íŒŒì¼ | ìœ„ì¹˜ | ì—­í•  |
|------|------|------|
| `EventType.cs` | Data/Enums/ | ì´ë²¤íŠ¸ íƒ€ì… |
| `LiveEventData.cs` | Data/ScriptableObjects/ | ì´ë²¤íŠ¸ SO ì •ì˜ |
| `LiveEventDatabase.cs` | Data/ScriptableObjects/ | ì´ë²¤íŠ¸ DB |
| `EventMissionData.cs` | Data/ScriptableObjects/ | ì´ë²¤íŠ¸ ë¯¸ì…˜ SO |
| `LiveEvent.json` | Data/MasterData/ | ìƒ˜í”Œ ë°ì´í„° |

#### EventType ì •ì˜
```csharp
public enum EventType
{
    Mission,        // ë¯¸ì…˜ ë‹¬ì„±í˜•
    Shop,           // ì´ë²¤íŠ¸ ìƒì 
    Stage,          // ì´ë²¤íŠ¸ ìŠ¤í…Œì´ì§€
    Login,          // ì¶œì„ ì´ë²¤íŠ¸
    Collection,     // ìˆ˜ì§‘ ì´ë²¤íŠ¸
    Composite,      // ë³µí•©í˜• (ë¯¸ì…˜ + ìƒì  + ìŠ¤í…Œì´ì§€)
}
```

#### LiveEventData í•„ë“œ
```csharp
[CreateAssetMenu]
public class LiveEventData : ScriptableObject
{
    public string Id;
    public string Name;
    public string Description;
    public EventType EventType;
    public long StartAt;                // Unix timestamp
    public long EndAt;
    public string BannerImagePath;
    public string DetailImagePath;

    // ì´ë²¤íŠ¸ ì»¨í…ì¸  (íƒ€ì…ë³„ ì„ íƒì )
    public string[] MissionIds;         // EventMissionData ì°¸ì¡°
    public string[] ShopProductIds;     // ì´ë²¤íŠ¸ ì „ìš© ìƒí’ˆ
    public string[] StageIds;           // ì´ë²¤íŠ¸ ì „ìš© ìŠ¤í…Œì´ì§€

    // ì´ë²¤íŠ¸ ì¬í™”
    public CostType EventCurrencyType;  // ì´ë²¤íŠ¸ ì „ìš© ì¬í™”
}
```

#### EventMissionData í•„ë“œ
```csharp
[CreateAssetMenu]
public class EventMissionData : ScriptableObject
{
    public string Id;
    public string EventId;              // ì†Œì† ì´ë²¤íŠ¸
    public string Description;          // "ìŠ¤í…Œì´ì§€ 10íšŒ í´ë¦¬ì–´"
    public MissionConditionType ConditionType;
    public string ConditionParam;       // ì¡°ê±´ íŒŒë¼ë¯¸í„°
    public int RequiredCount;           // ëª©í‘œ íšŸìˆ˜
    public RewardInfo[] Rewards;        // ì™„ë£Œ ë³´ìƒ
    public int DisplayOrder;
}

public enum MissionConditionType
{
    ClearStage,         // ìŠ¤í…Œì´ì§€ í´ë¦¬ì–´
    ClearStageCount,    // ìŠ¤í…Œì´ì§€ NíšŒ í´ë¦¬ì–´
    GachaCount,         // ê°€ì±  NíšŒ
    PurchaseCount,      // êµ¬ë§¤ NíšŒ
    LoginCount,         // ì¶œì„ Nì¼
    CollectItem,        // ì•„ì´í…œ ìˆ˜ì§‘
    // ... í™•ì¥ ê°€ëŠ¥
}
```

### 4.2 ìœ ì € ë°ì´í„°

#### LiveEventProgress ì¶”ê°€
```csharp
// UserSaveData.csì— ì¶”ê°€
public List<LiveEventProgress> EventProgress;

[Serializable]
public struct LiveEventProgress
{
    public string EventId;
    public List<EventMissionProgress> Missions;
}

[Serializable]
public struct EventMissionProgress
{
    public string MissionId;
    public int CurrentCount;
    public bool IsCompleted;
    public bool IsRewardClaimed;
}
```

### 4.3 Request/Response

#### GetActiveEventsRequest/Response
```csharp
[Serializable]
public struct GetActiveEventsRequest : IRequest
{
    public long Timestamp { get; set; }
}

[Serializable]
public struct GetActiveEventsResponse : IResponse
{
    public bool IsSuccess { get; set; }
    public string ErrorCode { get; set; }
    public long ServerTime { get; set; }

    public LiveEventInfo[] ActiveEvents;
}

[Serializable]
public struct LiveEventInfo
{
    public string EventId;
    public string Name;
    public long EndAt;
    public string BannerImagePath;
}
```

#### ClaimEventMissionRequest/Response
```csharp
[Serializable]
public struct ClaimEventMissionRequest : IRequest
{
    public string EventId;
    public string MissionId;
    public long Timestamp { get; set; }
}

[Serializable]
public struct ClaimEventMissionResponse : IResponse, IGameActionResponse
{
    public bool IsSuccess { get; set; }
    public string ErrorCode { get; set; }
    public long ServerTime { get; set; }
    public UserDataDelta Delta { get; set; }

    public RewardInfo[] Rewards;
}
```

### 4.4 ì´ë²¤íŠ¸

#### LiveEventEvents.cs
```csharp
public struct EventStartedEvent
{
    public string EventId;
}

public struct EventEndedEvent
{
    public string EventId;
}

public struct EventMissionProgressedEvent
{
    public string EventId;
    public string MissionId;
    public int CurrentCount;
    public int RequiredCount;
}

public struct EventMissionCompletedEvent
{
    public string EventId;
    public string MissionId;
}

public struct EventRewardClaimedEvent
{
    public string EventId;
    public string MissionId;
    public RewardInfo[] Rewards;
}
```

### 4.5 UI

#### ì‚°ì¶œë¬¼

| íŒŒì¼ | ìœ„ì¹˜ | ì—­í•  |
|------|------|------|
| `EventDashboardScreen.cs` | Contents/OutGame/Event/ | ì´ë²¤íŠ¸ ëŒ€ì‹œë³´ë“œ |
| `EventBannerItem.cs` | Contents/OutGame/Event/ | ë°°ë„ˆ ì•„ì´í…œ |
| `EventDetailScreen.cs` | Contents/OutGame/Event/ | ì´ë²¤íŠ¸ ìƒì„¸ |
| `EventMissionItem.cs` | Contents/OutGame/Event/ | ë¯¸ì…˜ ì•„ì´í…œ |

#### EventDashboardScreen êµ¬ì¡°
```
[EventDashboardScreen]
â”œâ”€â”€ ScreenHeader
â”œâ”€â”€ BannerScrollView (ê°€ë¡œ ìŠ¤í¬ë¡¤)
â”‚   â””â”€â”€ EventBannerItem[]
â”‚       â”œâ”€â”€ BannerImage
â”‚       â”œâ”€â”€ EventName
â”‚       â”œâ”€â”€ RemainingTime
â”‚       â””â”€â”€ [ì§„ì…] ë²„íŠ¼
â””â”€â”€ NoEventMessage (ì´ë²¤íŠ¸ ì—†ì„ ë•Œ)
```

#### EventDetailScreen êµ¬ì¡°
```
[EventDetailScreen]
â”œâ”€â”€ ScreenHeader
â”œâ”€â”€ EventBannerImage
â”œâ”€â”€ EventDescription
â”œâ”€â”€ TabGroup (ë¯¸ì…˜/ìƒì /ìŠ¤í…Œì´ì§€)
â”œâ”€â”€ ContentArea
â”‚   â”œâ”€â”€ MissionList
â”‚   â”‚   â””â”€â”€ EventMissionItem[]
â”‚   â”‚       â”œâ”€â”€ Description
â”‚   â”‚       â”œâ”€â”€ Progress (n/m)
â”‚   â”‚       â””â”€â”€ [ë³´ìƒ ë°›ê¸°] ë²„íŠ¼
â”‚   â”œâ”€â”€ EventShopList (ìƒì  íƒ­)
â”‚   â””â”€â”€ EventStageList (ìŠ¤í…Œì´ì§€ íƒ­)
â””â”€â”€ EventCurrencyDisplay
```

### 4.6 ì²´í¬ë¦¬ìŠ¤íŠ¸

```
Phase 4 ì²´í¬ë¦¬ìŠ¤íŠ¸:

ë§ˆìŠ¤í„° ë°ì´í„°:
- [ ] EventType.cs ìƒì„±
- [ ] MissionConditionType.cs ìƒì„±
- [ ] LiveEventData.cs ìƒì„±
- [ ] LiveEventDatabase.cs ìƒì„±
- [ ] EventMissionData.cs ìƒì„±
- [ ] EventMissionDatabase.cs ìƒì„±
- [ ] LiveEvent.json ìƒ˜í”Œ ë°ì´í„°
- [ ] EventMission.json ìƒ˜í”Œ ë°ì´í„°
- [ ] MasterDataImporterì— LiveEvent, EventMission ì¶”ê°€

ìœ ì € ë°ì´í„°:
- [ ] LiveEventProgress êµ¬ì¡°ì²´ ì¶”ê°€
- [ ] EventMissionProgress êµ¬ì¡°ì²´ ì¶”ê°€
- [ ] UserSaveDataì— EventProgress í•„ë“œ ì¶”ê°€

Request/Response:
- [ ] GetActiveEventsRequest.cs ìƒì„±
- [ ] GetActiveEventsResponse.cs ìƒì„±
- [ ] ClaimEventMissionRequest.cs ìƒì„±
- [ ] ClaimEventMissionResponse.cs ìƒì„±

API:
- [ ] LocalApiClient.GetActiveEventsAsync êµ¬í˜„
- [ ] LocalApiClient.ClaimEventMissionAsync êµ¬í˜„
- [ ] ì´ë²¤íŠ¸ ê¸°ê°„ ê²€ì¦ ë¡œì§
- [ ] ë¯¸ì…˜ ì§„í–‰ë„ ì—…ë°ì´íŠ¸ ë¡œì§

ì´ë²¤íŠ¸:
- [ ] LiveEventEvents.cs ìƒì„±

UI:
- [ ] Sc.Contents.Event Assembly ìƒì„±
- [ ] EventDashboardScreen.cs ìƒì„±
- [ ] EventBannerItem.cs ìƒì„±
- [ ] EventDetailScreen.cs ìƒì„±
- [ ] EventMissionItem.cs ìƒì„±
- [ ] MVPSceneSetupì— Event í”„ë¦¬íŒ¹ ì¶”ê°€

ì—°ë™:
- [ ] LobbyScreenì— ì´ë²¤íŠ¸ ë²„íŠ¼ ì¶”ê°€
- [ ] ì´ë²¤íŠ¸ ìƒì  ì—°ë™ (ShopScreen ì¬ì‚¬ìš©)
- [ ] ì´ë²¤íŠ¸ ìŠ¤í…Œì´ì§€ ì—°ë™ (StageListScreen ì¬ì‚¬ìš©)
```

### 4.7 ìƒì„¸ ìŠ¤í™ ë¬¸ì„œ
- [LiveEvent.md](../Specs/LiveEvent.md) (ê¸°ì¡´ í™•ì¥)
- [EventDashboardScreen.md](../Specs/LiveEvent/EventDashboardScreen.md)
- [EventDetailScreen.md](../Specs/LiveEvent/EventDetailScreen.md)

---

## Phase 5: ê¸°ì¡´ ê¸°ëŠ¥ ê°•í™”

> **ëª©í‘œ**: Phase 0~4 ì‹œìŠ¤í…œê³¼ ì—°ë™í•˜ì—¬ MVP ì™„ì„±ë„ í–¥ìƒ
> **ìƒíƒœ**: âœ… ì„¤ê³„ ì™„ë£Œ

### ì„¤ê³„ ì›ì¹™

**í•µì‹¬ ë°©í–¥**: ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€ë³´ë‹¤ **Phase 0~4 ì‹œìŠ¤í…œê³¼ì˜ ì—°ë™**ì— ì§‘ì¤‘
- Phase 0 ì¸í”„ë¼ ì ìš©: Log, Result<T>, SaveManager, LoadingIndicator
- Phase 1 íŒì—… í†µí•©: CostConfirmPopup, RewardPopup, AlertPopup
- Phase 3 ê³µì‹ ì¬ì‚¬ìš©: ì „íˆ¬ë ¥ ê³„ì‚° ê³µì‹
- Phase 4 íŒ¨í„´ ì°¸ì¡°: ë°°ë„ˆ UI íŒ¨í„´, ë‚¨ì€ ì‹œê°„ í‘œì‹œ

---

### 5.1 ê°€ì±  ê°•í™”

> **Phase ì—°ê³„**: Phase 1 RewardPopup, Phase 4 ë°°ë„ˆ íŒ¨í„´

#### í•µì‹¬ ë³€ê²½

| ê¸°ëŠ¥ | í˜„ì¬ | ë³€ê²½ | ì—°ê³„ |
|------|------|------|------|
| ê²°ê³¼ í‘œì‹œ | GachaResultPopup | RewardPopup ì‚¬ìš© | Phase 1 |
| ë°°ë„ˆ UI | ë‹¨ì¼ ê³ ì • | ë‹¤ì¤‘ ë°°ë„ˆ ìŠ¤í¬ë¡¤ | Phase 4 EventBannerItem |
| ì²œì¥ í‘œì‹œ | ì—†ìŒ | í™•ë¥  + ë‚¨ì€ íšŸìˆ˜ | Phase 2 TimeHelper |
| ì—ëŸ¬ ì²˜ë¦¬ | ì§ì ‘ ì²˜ë¦¬ | AlertPopup + ErrorCode | Phase 0, 1 |

#### ë§ˆìŠ¤í„° ë°ì´í„° í™•ì¥

```csharp
// GachaPoolData.cs í™•ì¥
public class GachaPoolData : ScriptableObject
{
    // ê¸°ì¡´ í•„ë“œ...

    [Header("ë°°ë„ˆ ì •ë³´")]
    public string BannerImagePath;
    public string BannerNameKey;
    public DateTime StartTime;          // ê¸°ê°„ í•œì •
    public DateTime EndTime;
    public bool IsPickup;               // í”½ì—… ì—¬ë¶€
    public string[] PickupCharacterIds; // í”½ì—… ìºë¦­í„°
    public int DisplayOrder;            // í‘œì‹œ ìˆœì„œ

    [Header("ì²œì¥ ì •ë³´")]
    public int PityThreshold;           // ì²œì¥ íšŸìˆ˜
    public float PityRate;              // ì²œì¥ í™•ë¥  ë³´ë„ˆìŠ¤
    public bool ShowPityProgress;       // UIì— ì²œì¥ ì§„í–‰ë„ í‘œì‹œ
}
```

#### UI êµ¬ì¡°

```
[GachaScreen] (ë¦¬íŒ©í† ë§)
â”œâ”€â”€ ScreenHeader
â”œâ”€â”€ BannerScrollView (ê°€ë¡œ ìŠ¤í¬ë¡¤)           â† Phase 4 íŒ¨í„´ ì°¸ì¡°
â”‚   â””â”€â”€ GachaBannerItem[]
â”‚       â”œâ”€â”€ BannerImage
â”‚       â”œâ”€â”€ BannerName
â”‚       â”œâ”€â”€ RemainingTime (TimeHelper)      â† Phase 2 ì—°ê³„
â”‚       â””â”€â”€ PickupCharacterIcons
â”œâ”€â”€ SelectedBannerInfo
â”‚   â”œâ”€â”€ PickupRates (í™•ë¥  í‘œì‹œ)
â”‚   â”œâ”€â”€ PityProgress (n/ì²œì¥)               â† ì‹ ê·œ
â”‚   â””â”€â”€ CostDisplay
â”œâ”€â”€ ActionButtons
â”‚   â”œâ”€â”€ [1íšŒ ì†Œí™˜] â†’ CostConfirmPopup       â† Phase 1 ì—°ê³„
â”‚   â””â”€â”€ [10íšŒ ì†Œí™˜] â†’ CostConfirmPopup
â””â”€â”€ [íˆìŠ¤í† ë¦¬] ë²„íŠ¼ â†’ GachaHistoryScreen
```

#### GachaHistoryScreen (ì‹ ê·œ)

```
[GachaHistoryScreen]
â”œâ”€â”€ ScreenHeader
â”œâ”€â”€ FilterTabs (ì „ì²´/í”½ì—…/ì¼ë°˜)
â”œâ”€â”€ HistoryScrollView
â”‚   â””â”€â”€ GachaHistoryItem[]
â”‚       â”œâ”€â”€ Timestamp (TimeHelper)          â† Phase 2 ì—°ê³„
â”‚       â”œâ”€â”€ BannerName
â”‚       â”œâ”€â”€ ResultSummary (â˜…5 x1, â˜…4 x3...)
â”‚       â””â”€â”€ [ìƒì„¸] ë²„íŠ¼
â””â”€â”€ Pagination
```

#### ìœ ì € ë°ì´í„° í™•ì¥

```csharp
// UserSaveData.csì— ì¶”ê°€
public List<GachaHistoryRecord> GachaHistory;

[Serializable]
public struct GachaHistoryRecord
{
    public string PoolId;
    public long Timestamp;
    public GachaPullType PullType;      // Single, Multi
    public List<GachaResultItem> Results;
}
```

#### Request/Response í™•ì¥

```csharp
// GachaResponse í™•ì¥
public struct GachaResponse : IGameActionResponse
{
    // ê¸°ì¡´ í•„ë“œ...
    public int CurrentPityCount;        // í˜„ì¬ ì²œì¥ ì¹´ìš´íŠ¸
    public int PityThreshold;           // ì²œì¥ ë„ë‹¬ íšŸìˆ˜
}
```

#### ì²´í¬ë¦¬ìŠ¤íŠ¸

```
ê°€ì±  ê°•í™” (Phase 5.1):

ë§ˆìŠ¤í„° ë°ì´í„°:
- [ ] GachaPoolData.cs í™•ì¥ (ë°°ë„ˆ, ì²œì¥ ì •ë³´)
- [ ] GachaPool.json ìƒ˜í”Œ ë°ì´í„° ì—…ë°ì´íŠ¸

ìœ ì € ë°ì´í„°:
- [ ] GachaHistoryRecord êµ¬ì¡°ì²´ ì¶”ê°€
- [ ] UserSaveDataì— GachaHistory í•„ë“œ ì¶”ê°€

UI:
- [ ] GachaBannerItem.cs ìƒì„±
- [ ] GachaScreen ë¦¬íŒ©í† ë§ (ë°°ë„ˆ ìŠ¤í¬ë¡¤)
- [ ] GachaHistoryScreen.cs ìƒì„±
- [ ] GachaHistoryItem.cs ìƒì„±

ì—°ë™:
- [ ] GachaResultPopup â†’ RewardPopup êµì²´
- [ ] ì†Œí™˜ ë²„íŠ¼ â†’ CostConfirmPopup ì—°ë™
- [ ] ì—ëŸ¬ â†’ AlertPopup + ErrorCode ì—°ë™
- [ ] ë¡œë”© â†’ LoadingIndicator ì ìš©
- [ ] ì‹œê°„ í‘œì‹œ â†’ TimeHelper ì‚¬ìš©
```

---

### 5.2 ìºë¦­í„° ê°•í™”

> **Phase ì—°ê³„**: Phase 1 CostConfirmPopup/RewardPopup, Phase 3 ì „íˆ¬ë ¥ ê³µì‹

#### í•µì‹¬ ë³€ê²½

| ê¸°ëŠ¥ | í˜„ì¬ | ë³€ê²½ | ì—°ê³„ |
|------|------|------|------|
| ì „íˆ¬ë ¥ | ì—†ìŒ | Phase 3 ê³µì‹ ì‚¬ìš© | Phase 3 |
| ë ˆë²¨ì—… | ì—†ìŒ | ì¬ë£Œ ì†Œë¹„ â†’ ë ˆë²¨ì—… | Phase 1 CostConfirmPopup |
| ê²°ê³¼ í‘œì‹œ | ì—†ìŒ | RewardPopup + ìŠ¤íƒ¯ ë¹„êµ | Phase 1 |
| ì¥ë¹„ ì‹œìŠ¤í…œ | ì—†ìŒ | ItemCategory.Equipment ì—°ë™ | Phase 1 |

#### ë§ˆìŠ¤í„° ë°ì´í„° í™•ì¥

```csharp
// CharacterLevelData.cs (ì‹ ê·œ)
[CreateAssetMenu]
public class CharacterLevelData : ScriptableObject
{
    public Rarity Rarity;
    public LevelRequirement[] LevelRequirements;
}

[Serializable]
public struct LevelRequirement
{
    public int Level;
    public int RequiredExp;             // í•„ìš” ê²½í—˜ì¹˜
    public int GoldCost;                // ê³¨ë“œ ë¹„ìš©
}

// CharacterAscensionData.cs (ì‹ ê·œ)
[CreateAssetMenu]
public class CharacterAscensionData : ScriptableObject
{
    public Rarity Rarity;
    public AscensionRequirement[] AscensionRequirements;
}

[Serializable]
public struct AscensionRequirement
{
    public int AscensionLevel;          // 0â†’1, 1â†’2, ...
    public int RequiredCharacterLevel;  // í•„ìš” ìºë¦­í„° ë ˆë²¨
    public List<RewardInfo> Materials;  // í•„ìš” ì¬ë£Œ (Phase 1 RewardInfo)
    public int GoldCost;
    public StatBonus StatBonus;         // ëŒíŒŒ ì‹œ ìŠ¤íƒ¯ ë³´ë„ˆìŠ¤
}

[Serializable]
public struct StatBonus
{
    public int HP, ATK, DEF, SPD;
    public float CritRate, CritDamage;
}
```

#### UI êµ¬ì¡°

##### CharacterListScreen ê°•í™”

```
[CharacterListScreen] (ë¦¬íŒ©í† ë§)
â”œâ”€â”€ ScreenHeader
â”œâ”€â”€ FilterBar
â”‚   â”œâ”€â”€ RarityFilter (â˜…1~â˜…5)
â”‚   â”œâ”€â”€ ClassFilter (Warrior/Mage/...)
â”‚   â””â”€â”€ ElementFilter (Fire/Water/...)
â”œâ”€â”€ SortDropdown
â”‚   â”œâ”€â”€ ë ˆë²¨ìˆœ
â”‚   â”œâ”€â”€ í¬ê·€ë„ìˆœ
â”‚   â”œâ”€â”€ ì „íˆ¬ë ¥ìˆœ                        â† Phase 3 ê³µì‹
â”‚   â””â”€â”€ íšë“ìˆœ
â”œâ”€â”€ CharacterGrid
â”‚   â””â”€â”€ CharacterCard[]
â”‚       â”œâ”€â”€ CharacterIcon
â”‚       â”œâ”€â”€ Rarity Stars
â”‚       â”œâ”€â”€ Level
â”‚       â”œâ”€â”€ PowerDisplay                 â† Phase 3 ê³µì‹
â”‚       â””â”€â”€ Element Badge
â””â”€â”€ TotalInfo (ë³´ìœ : n/m)
```

##### CharacterDetailScreen ê°•í™”

```
[CharacterDetailScreen] (ë¦¬íŒ©í† ë§)
â”œâ”€â”€ ScreenHeader
â”œâ”€â”€ CharacterVisual
â”œâ”€â”€ BasicInfo
â”‚   â”œâ”€â”€ Name, Rarity, Class, Element
â”‚   â””â”€â”€ PowerDisplay                     â† Phase 3 ê³µì‹
â”œâ”€â”€ TabGroup
â”‚   â”œâ”€â”€ [ìŠ¤íƒ¯] íƒ­
â”‚   â”‚   â”œâ”€â”€ HP, ATK, DEF, SPD
â”‚   â”‚   â”œâ”€â”€ CritRate, CritDamage
â”‚   â”‚   â””â”€â”€ PowerBreakdown
â”‚   â”œâ”€â”€ [ìŠ¤í‚¬] íƒ­
â”‚   â””â”€â”€ [ì¥ë¹„] íƒ­
â”‚       â””â”€â”€ EquipmentSlots (5ê°œ)         â† Phase 1 ItemCategory
â”œâ”€â”€ ActionButtons
â”‚   â”œâ”€â”€ [ë ˆë²¨ì—…] â†’ CharacterLevelUpPopup
â”‚   â””â”€â”€ [ëŒíŒŒ] â†’ CharacterAscensionPopup
```

##### CharacterLevelUpPopup (ì‹ ê·œ)

```
[CharacterLevelUpPopup] (Popup)
â”œâ”€â”€ CurrentLevel â†’ TargetLevel
â”œâ”€â”€ StatComparison
â”‚   â”œâ”€â”€ Before Stats
â”‚   â””â”€â”€ After Stats (ë³€í™”ëŸ‰ í‘œì‹œ)
â”œâ”€â”€ MaterialSelector
â”‚   â”œâ”€â”€ ExpMaterialItem[] (ë³´ìœ ëŸ‰ í‘œì‹œ)
â”‚   â””â”€â”€ AutoSelect ë²„íŠ¼
â”œâ”€â”€ CostDisplay (ê³¨ë“œ)
â””â”€â”€ [ë ˆë²¨ì—…] ë²„íŠ¼ â†’ CostConfirmPopup    â† Phase 1 ì—°ê³„
```

##### CharacterAscensionPopup (ì‹ ê·œ)

```
[CharacterAscensionPopup] (Popup)
â”œâ”€â”€ CurrentAscension â†’ NextAscension
â”œâ”€â”€ RequiredLevel ì²´í¬ (ì¡°ê±´ ë¯¸ì¶©ì¡± ì‹œ ì ê¸ˆ)
â”œâ”€â”€ MaterialList
â”‚   â””â”€â”€ MaterialSlot[] (ë³´ìœ /í•„ìš”)
â”œâ”€â”€ StatBonus Preview
â”œâ”€â”€ CostDisplay (ê³¨ë“œ)
â””â”€â”€ [ëŒíŒŒ] ë²„íŠ¼ â†’ CostConfirmPopup      â† Phase 1 ì—°ê³„
```

#### Request/Response

```csharp
// CharacterLevelUpRequest.cs
[Serializable]
public struct CharacterLevelUpRequest : IRequest
{
    public long Timestamp { get; set; }
    public string CharacterInstanceId;
    public Dictionary<string, int> MaterialUsage;  // ItemId â†’ ì‚¬ìš©ëŸ‰
}

// CharacterLevelUpResponse.cs
[Serializable]
public struct CharacterLevelUpResponse : IGameActionResponse
{
    public bool IsSuccess { get; set; }
    public ErrorCode ErrorCode { get; set; }
    public long ServerTime { get; set; }
    public UserDataDelta Delta { get; set; }

    public int PreviousLevel;
    public int NewLevel;
    public CharacterStats PreviousStats;
    public CharacterStats NewStats;
}

// CharacterAscensionRequest.cs
[Serializable]
public struct CharacterAscensionRequest : IRequest
{
    public long Timestamp { get; set; }
    public string CharacterInstanceId;
}

// CharacterAscensionResponse.cs
[Serializable]
public struct CharacterAscensionResponse : IGameActionResponse
{
    public bool IsSuccess { get; set; }
    public ErrorCode ErrorCode { get; set; }
    public long ServerTime { get; set; }
    public UserDataDelta Delta { get; set; }

    public int PreviousAscension;
    public int NewAscension;
    public CharacterStats PreviousStats;
    public CharacterStats NewStats;
}
```

#### ì—ëŸ¬ ì½”ë“œ

| ErrorCode | ê°’ | ì„¤ëª… |
|-----------|-----|------|
| `CharacterNotFound` | 7001 | ìºë¦­í„° ì—†ìŒ |
| `CharacterMaxLevel` | 7002 | ìµœëŒ€ ë ˆë²¨ ë„ë‹¬ |
| `CharacterInsufficientMaterial` | 7003 | ì¬ë£Œ ë¶€ì¡± |
| `CharacterInsufficientGold` | 7004 | ê³¨ë“œ ë¶€ì¡± |
| `CharacterLevelRequirementNotMet` | 7005 | ëŒíŒŒ ë ˆë²¨ ìš”êµ¬ì‚¬í•­ ë¯¸ì¶©ì¡± |
| `CharacterMaxAscension` | 7006 | ìµœëŒ€ ëŒíŒŒ ë„ë‹¬ |

#### ì²´í¬ë¦¬ìŠ¤íŠ¸

```
ìºë¦­í„° ê°•í™” (Phase 5.2):

ë§ˆìŠ¤í„° ë°ì´í„°:
- [ ] CharacterLevelData.cs ìƒì„±
- [ ] CharacterAscensionData.cs ìƒì„±
- [ ] CharacterLevel.json ìƒ˜í”Œ ë°ì´í„°
- [ ] CharacterAscension.json ìƒ˜í”Œ ë°ì´í„°
- [ ] MasterDataImporterì— ì¶”ê°€

ìœ ì € ë°ì´í„°:
- [ ] OwnedCharacter.cs í™•ì¥ (CurrentExp ì¶”ê°€)

Request/Response:
- [ ] CharacterLevelUpRequest.cs
- [ ] CharacterLevelUpResponse.cs
- [ ] CharacterAscensionRequest.cs
- [ ] CharacterAscensionResponse.cs

ì´ë²¤íŠ¸:
- [ ] CharacterEvents.cs
  - [ ] CharacterLevelUpEvent
  - [ ] CharacterAscensionEvent

API:
- [ ] LocalApiClient.LevelUpCharacterAsync êµ¬í˜„
- [ ] LocalApiClient.AscendCharacterAsync êµ¬í˜„

UI:
- [ ] CharacterListScreen ë¦¬íŒ©í† ë§ (í•„í„°/ì •ë ¬)
- [ ] CharacterDetailScreen ë¦¬íŒ©í† ë§ (íƒ­, ì•¡ì…˜)
- [ ] CharacterLevelUpPopup.cs ìƒì„±
- [ ] CharacterAscensionPopup.cs ìƒì„±
- [ ] CharacterFilterBar.cs ìƒì„±
- [ ] CharacterSortDropdown.cs ìƒì„±

ì—°ë™:
- [ ] ì „íˆ¬ë ¥ ê³„ì‚° â†’ Phase 3 ê³µì‹ ì‚¬ìš©
- [ ] ë ˆë²¨ì—…/ëŒíŒŒ â†’ CostConfirmPopup ì—°ë™
- [ ] ê²°ê³¼ â†’ RewardPopup ì—°ë™ (ìŠ¤íƒ¯ ë³€í™”)
- [ ] ì—ëŸ¬ â†’ AlertPopup + ErrorCode ì—°ë™
- [ ] ë¡œë”© â†’ LoadingIndicator ì ìš©
```

---

### 5.3 Navigation ê°•í™”

> **Phase ì—°ê³„**: Phase 3 StageDashboard íƒ­ íŒ¨í„´, Phase 4 ì•Œë¦¼ ë°°ì§€

#### í•µì‹¬ ë³€ê²½

| ê¸°ëŠ¥ | í˜„ì¬ | ë³€ê²½ | ì—°ê³„ |
|------|------|------|------|
| Shortcut | ì„¤ê³„ë§Œ | API êµ¬í˜„ | - |
| DeepLink | ì—†ìŒ | URL íŒŒì‹± â†’ í™”ë©´ ì´ë™ | - |
| íƒ­ ê·¸ë£¹ | ì—†ìŒ | ë¡œë¹„ í•˜ë‹¨ íƒ­ | Phase 3 íŒ¨í„´ |
| ì•Œë¦¼ ë°°ì§€ | ì—†ìŒ | ê° ë©”ë‰´ ì•Œë¦¼ | Phase 4 HasClaimableReward |

#### Shortcut API êµ¬í˜„

```csharp
// NavigationManager.cs í™•ì¥
public class NavigationManager
{
    // ê¸°ì¡´ ë©”ì„œë“œ...

    /// <summary>
    /// íŠ¹ì • í™”ë©´ìœ¼ë¡œ ë°”ë¡œ ì´ë™ (ìŠ¤íƒì— ì¶”ê°€)
    /// </summary>
    public async UniTask ShortcutAsync<T>(object state = null) where T : ScreenWidget
    {
        var context = CreateContext<T>(state);
        await PushAsync(context);
    }

    /// <summary>
    /// DeepLink URL ì²˜ë¦¬
    /// </summary>
    public async UniTask HandleDeepLinkAsync(string url)
    {
        var route = DeepLinkParser.Parse(url);
        if (route == null) return;

        await ShortcutAsync(route.ScreenType, route.State);
    }
}
```

#### DeepLink ì‹œìŠ¤í…œ

```csharp
// DeepLinkParser.cs (ì‹ ê·œ)
public static class DeepLinkParser
{
    // URL í˜•ì‹: projectsc://screen/gacha?poolId=xxx
    //           projectsc://screen/character/detail?id=xxx
    //           projectsc://screen/event?eventId=xxx

    public static DeepLinkRoute Parse(string url)
    {
        // URL íŒŒì‹± ë¡œì§
    }
}

public struct DeepLinkRoute
{
    public Type ScreenType;
    public object State;
}
```

#### íƒ­ ê·¸ë£¹ ì‹œìŠ¤í…œ

```csharp
// TabGroupWidget.cs (ì‹ ê·œ)
public class TabGroupWidget : Widget
{
    [SerializeField] private TabButton[] _tabs;
    [SerializeField] private GameObject[] _contentPanels;

    public event Action<int> OnTabChanged;

    public int CurrentTabIndex { get; private set; }

    public void SelectTab(int index);
    public void SetBadge(int tabIndex, bool show);
    public void SetBadgeCount(int tabIndex, int count);
}

// LobbyScreen ë¦¬íŒ©í† ë§
[LobbyScreen]
â”œâ”€â”€ ScreenHeader (optional)
â”œâ”€â”€ CurrencyHUD
â”œâ”€â”€ TabContentArea (ì¤‘ì•™)
â”‚   â”œâ”€â”€ HomeTab
â”‚   â”œâ”€â”€ CharacterTab
â”‚   â”œâ”€â”€ GachaTab
â”‚   â””â”€â”€ SettingsTab
â””â”€â”€ TabBar (í•˜ë‹¨)
    â”œâ”€â”€ [í™ˆ] íƒ­ (ë°°ì§€: ë³´ìƒ ê°€ëŠ¥)
    â”œâ”€â”€ [ìºë¦­í„°] íƒ­
    â”œâ”€â”€ [ê°€ì± ] íƒ­ (ë°°ì§€: ë¬´ë£Œ ê°€ì± )
    â””â”€â”€ [ì„¤ì •] íƒ­
```

#### ì•Œë¦¼ ë°°ì§€ ì‹œìŠ¤í…œ

```csharp
// BadgeManager.cs (ì‹ ê·œ)
public class BadgeManager : Singleton<BadgeManager>
{
    public event Action<string, int> OnBadgeChanged;

    // ë°°ì§€ ì¹´ìš´íŠ¸ ì¡°íšŒ
    public int GetBadgeCount(BadgeType type);

    // ë°°ì§€ ê°±ì‹  (ì„œë²„ ì‘ë‹µ í›„ í˜¸ì¶œ)
    public void RefreshBadges(UserSaveData data);
}

public enum BadgeType
{
    Home,           // ì¶œì„ ë³´ìƒ, ìš°í¸í•¨
    Character,      // ë ˆë²¨ì—… ê°€ëŠ¥
    Gacha,          // ë¬´ë£Œ ê°€ì±  ê°€ëŠ¥
    Shop,           // ë¬´ë£Œ ìƒí’ˆ
    Event,          // ìˆ˜ë ¹ ê°€ëŠ¥ ë³´ìƒ (Phase 4 ì—°ê³„)
    Stage,          // í´ë¦¬ì–´ ê°€ëŠ¥ ìŠ¤í…Œì´ì§€
}
```

#### ì²´í¬ë¦¬ìŠ¤íŠ¸

```
Navigation ê°•í™” (Phase 5.3):

Core:
- [ ] NavigationManager.ShortcutAsync êµ¬í˜„
- [ ] NavigationManager.HandleDeepLinkAsync êµ¬í˜„
- [ ] DeepLinkParser.cs ìƒì„±
- [ ] DeepLinkRoute.cs ìƒì„±

ë°°ì§€ ì‹œìŠ¤í…œ:
- [ ] BadgeManager.cs ìƒì„±
- [ ] BadgeType.cs ìƒì„±

UI:
- [ ] TabGroupWidget.cs ìƒì„±
- [ ] TabButton.cs ìƒì„±
- [ ] LobbyScreen ë¦¬íŒ©í† ë§ (íƒ­ êµ¬ì¡°)
- [ ] ê° íƒ­ì— ë°°ì§€ í‘œì‹œ

ì—°ë™:
- [ ] Phase 4 HasClaimableReward â†’ Event ë°°ì§€
- [ ] ë¬´ë£Œ ê°€ì±  â†’ Gacha ë°°ì§€
- [ ] ì¶œì„ ë³´ìƒ â†’ Home ë°°ì§€
```

---

### 5.4 ê³µí†µ UI ì—°ë™

> **Phase ì—°ê³„**: Phase 0 ì¸í”„ë¼, Phase 1 íŒì—…

#### LoadingIndicator ì ìš©

ëª¨ë“  ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì— LoadingIndicator ì ìš©:

```csharp
// ì ìš© ëŒ€ìƒ
- GachaScreen.OnPullButtonClicked()
- ShopScreen.OnPurchaseButtonClicked()
- CharacterLevelUpPopup.OnLevelUpClicked()
- CharacterAscensionPopup.OnAscendClicked()
- StageScreen.OnBattleStartClicked()
- EventDetailScreen.OnClaimMissionClicked()
```

#### SystemPopup í†µí•©

ê¸°ì¡´ ì§ì ‘ êµ¬í˜„ íŒì—…ì„ Phase 1 íŒì—…ìœ¼ë¡œ êµì²´:

| ê¸°ì¡´ | Phase 1 êµì²´ |
|------|-------------|
| í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ ì§ì ‘ êµ¬í˜„ | ConfirmPopup |
| ì•Œë¦¼ ë‹¤ì´ì–¼ë¡œê·¸ ì§ì ‘ êµ¬í˜„ | AlertPopup |
| ì¬í™” ì†Œë¹„ í™•ì¸ ì§ì ‘ êµ¬í˜„ | CostConfirmPopup |
| ë³´ìƒ ê²°ê³¼ ì§ì ‘ êµ¬í˜„ | RewardPopup |

#### Result<T> íŒ¨í„´ ì ìš©

LocalApiClient ë°˜í™˜ íƒ€ì…ì„ Result<T>ë¡œ í†µì¼:

```csharp
// Before
public async UniTask<GachaResponse> GachaAsync(GachaRequest request)

// After
public async UniTask<Result<GachaResponse>> GachaAsync(GachaRequest request)
```

#### Log ì ìš©

ì£¼ìš” ì•¡ì…˜ì— Log í˜¸ì¶œ ì¶”ê°€:

```csharp
Log.Info("Gacha", $"Pull requested: PoolId={request.PoolId}, Type={request.PullType}");
Log.Error("Gacha", $"Pull failed: {response.ErrorCode}");
```

#### ì²´í¬ë¦¬ìŠ¤íŠ¸

```
ê³µí†µ UI ì—°ë™ (Phase 5.4):

LoadingIndicator:
- [ ] GachaScreen ì ìš©
- [ ] ShopScreen ì ìš©
- [ ] CharacterLevelUpPopup ì ìš©
- [ ] CharacterAscensionPopup ì ìš©
- [ ] StageScreen ì ìš©
- [ ] EventDetailScreen ì ìš©

SystemPopup êµì²´:
- [ ] GachaResultPopup â†’ RewardPopup
- [ ] ê¸°ì¡´ í™•ì¸ì°½ â†’ ConfirmPopup
- [ ] ê¸°ì¡´ ì•Œë¦¼ì°½ â†’ AlertPopup
- [ ] ì¬í™” ì†Œë¹„ í™•ì¸ â†’ CostConfirmPopup

Result<T> ì ìš©:
- [ ] LocalApiClient ë°˜í™˜ íƒ€ì… ë³€ê²½
- [ ] í˜¸ì¶œë¶€ Result ì²˜ë¦¬ ì¶”ê°€

Log ì ìš©:
- [ ] Gacha ê´€ë ¨ ë¡œê·¸
- [ ] Shop ê´€ë ¨ ë¡œê·¸
- [ ] Character ê´€ë ¨ ë¡œê·¸
- [ ] Stage ê´€ë ¨ ë¡œê·¸
- [ ] Event ê´€ë ¨ ë¡œê·¸
```

---

### 5.5 ê²€ì¦ ì‹œë‚˜ë¦¬ì˜¤

#### ì‹œë‚˜ë¦¬ì˜¤ 4: ê°€ì±  ê°•í™” íë¦„
```
1. ë¡œë¹„ â†’ [ê°€ì± ] íƒ­ ë˜ëŠ” ë²„íŠ¼
2. GachaScreen (ë°°ë„ˆ ìŠ¤í¬ë¡¤) í‘œì‹œ
3. ë°°ë„ˆ ì„ íƒ â†’ ìƒì„¸ ì •ë³´ + ì²œì¥ ì§„í–‰ë„
4. [10íšŒ ì†Œí™˜] í´ë¦­
5. CostConfirmPopup í‘œì‹œ (Phase 1)
6. [í™•ì¸] í´ë¦­ â†’ LoadingIndicator í‘œì‹œ (Phase 0)
7. ì‘ë‹µ ìˆ˜ì‹  â†’ RewardPopup í‘œì‹œ (Phase 1)
8. ì²œì¥ ì¹´ìš´íŠ¸ ê°±ì‹ 
```

#### ì‹œë‚˜ë¦¬ì˜¤ 5: ìºë¦­í„° ë ˆë²¨ì—… íë¦„
```
1. ìºë¦­í„° ë¦¬ìŠ¤íŠ¸ (í•„í„°/ì •ë ¬ ì ìš©)
2. ìºë¦­í„° ì„ íƒ â†’ CharacterDetailScreen
3. ì „íˆ¬ë ¥ í‘œì‹œ í™•ì¸ (Phase 3 ê³µì‹)
4. [ë ˆë²¨ì—…] ë²„íŠ¼ í´ë¦­
5. CharacterLevelUpPopup í‘œì‹œ
6. ì¬ë£Œ ì„ íƒ â†’ ìŠ¤íƒ¯ ë³€í™” ë¯¸ë¦¬ë³´ê¸°
7. [ë ˆë²¨ì—…] í´ë¦­ â†’ CostConfirmPopup (Phase 1)
8. [í™•ì¸] í´ë¦­ â†’ LoadingIndicator (Phase 0)
9. ì‘ë‹µ ìˆ˜ì‹  â†’ RewardPopup (ìŠ¤íƒ¯ ë³€í™”)
10. ì „íˆ¬ë ¥ ê°±ì‹  í™•ì¸
```

---

### 5.6 ìƒì„¸ ìŠ¤í™ ë¬¸ì„œ
- [Gacha/Enhancement.md](../Specs/Gacha/Enhancement.md)
- [Character/Enhancement.md](../Specs/Character/Enhancement.md)
- [Common/NavigationEnhancement.md](../Specs/Common/NavigationEnhancement.md)
- [Common/LoadingIntegration.md](../Specs/Common/LoadingIntegration.md)

---

## ê²€ì¦ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ìƒì  êµ¬ë§¤ íë¦„
```
1. ë¡œë¹„ â†’ [ìƒì ] ë²„íŠ¼ í´ë¦­
2. ShopScreen í‘œì‹œ
3. ìƒí’ˆ íƒ­ ì„ íƒ (ì¬í™”/íŒ¨í‚¤ì§€/íŒ¨ìŠ¤)
4. ìƒí’ˆ ì•„ì´í…œ í´ë¦­
5. PurchaseConfirmPopup í‘œì‹œ
6. [êµ¬ë§¤] ë²„íŠ¼ í´ë¦­
7. NetworkManager.Send(ShopPurchaseRequest)
8. ì‘ë‹µ ìˆ˜ì‹  â†’ DataManager.ApplyDelta
9. RewardPopup í‘œì‹œ
10. CurrencyHUD ê°±ì‹  í™•ì¸
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: ìŠ¤í…Œì´ì§€ ì§„ì… íë¦„
```
1. ë¡œë¹„ â†’ [ìŠ¤í…Œì´ì§€] ë²„íŠ¼ í´ë¦­
2. StageListScreen í‘œì‹œ
3. ì±•í„° ì„ íƒ
4. ìŠ¤í…Œì´ì§€ ì•„ì´í…œ í´ë¦­
5. StageInfoPopup í‘œì‹œ (ë³´ìƒ, ì¶”ì²œ ì „íˆ¬ë ¥)
6. [ì¶œì „í•˜ê¸°] ë²„íŠ¼ í´ë¦­
7. PartySelectScreen í‘œì‹œ
8. ìºë¦­í„° 4ëª… ì„ íƒ
9. [ì „íˆ¬ ì‹œì‘] ë²„íŠ¼ í´ë¦­
10. NetworkManager.Send(StageBattleRequest)
11. ì‘ë‹µ ìˆ˜ì‹  â†’ BattleReadyEvent ë°œí–‰
12. (Battle ì‹œìŠ¤í…œ ì§„ì… ëŒ€ê¸°)
```

### ì‹œë‚˜ë¦¬ì˜¤ 3: ì´ë²¤íŠ¸ ë¯¸ì…˜ ë³´ìƒ ìˆ˜ë ¹
```
1. ë¡œë¹„ â†’ [ì´ë²¤íŠ¸] ë²„íŠ¼ í´ë¦­
2. EventDashboardScreen í‘œì‹œ
3. ì´ë²¤íŠ¸ ë°°ë„ˆ í´ë¦­
4. EventDetailScreen í‘œì‹œ
5. ë¯¸ì…˜ íƒ­ì—ì„œ ì™„ë£Œëœ ë¯¸ì…˜ í™•ì¸
6. [ë³´ìƒ ë°›ê¸°] ë²„íŠ¼ í´ë¦­
7. NetworkManager.Send(ClaimEventMissionRequest)
8. ì‘ë‹µ ìˆ˜ì‹  â†’ DataManager.ApplyDelta
9. RewardPopup í‘œì‹œ
10. ë¯¸ì…˜ ìƒíƒœ "ìˆ˜ë ¹ ì™„ë£Œ"ë¡œ ë³€ê²½
```

---

## ì‚°ì¶œë¬¼ ìš”ì•½

### ìƒˆë¡œ ìƒì„±í•  íŒŒì¼ (ì´ ~50ê°œ)

#### Data ë ˆì´ì–´ (~15ê°œ)
- Enums: RewardType, ProductType, LimitType, StageType, EventType, MissionConditionType
- Structs: RewardInfo, ShopPurchaseRecord, PartyPreset, LiveEventProgress, EventMissionProgress
- SO: ShopProductData, ShopProductDatabase, LiveEventData, LiveEventDatabase, EventMissionData, EventMissionDatabase

#### Packet ë ˆì´ì–´ (~8ê°œ)
- Requests: StageBattleRequest, GetActiveEventsRequest, ClaimEventMissionRequest
- Responses: StageBattleResponse, GetActiveEventsResponse, ClaimEventMissionResponse
- Structs: BattleInitialData, CharacterBattleData

#### Event ë ˆì´ì–´ (~4ê°œ)
- CommonPopupEvents, ShopEvents, StageEvents, LiveEventEvents

#### Core ë ˆì´ì–´ (~1ê°œ)
- RewardProcessor

#### Common ë ˆì´ì–´ (~2ê°œ)
- ConfirmPopup, RewardPopup

#### Contents ë ˆì´ì–´ (~20ê°œ)
- Shop: ShopScreen, ShopProductItem, PurchaseConfirmPopup
- Stage: StageListScreen, StageItem, StageInfoPopup, PartySelectScreen, PartySlotWidget, SelectableCharacterItem
- Event: EventDashboardScreen, EventBannerItem, EventDetailScreen, EventMissionItem
- (ê¸°ì¡´ ê°•í™” íŒŒì¼ë“¤)

### ìˆ˜ì •í•  íŒŒì¼ (~15ê°œ)
- UserSaveData.cs (v3~v4 ë§ˆì´ê·¸ë ˆì´ì…˜)
- LocalApiClient.cs (PurchaseAsync, StartBattleAsync, GetActiveEventsAsync ë“±)
- StageData.cs (í™•ì¥)
- LobbyScreen.cs (ë²„íŠ¼ ì¶”ê°€)
- MVPSceneSetup.cs (í”„ë¦¬íŒ¹ ì¶”ê°€)
- MasterDataImporter.cs (ìƒˆ SO íƒ€ì… ì¶”ê°€)
- ê°ì¢… JSON ìƒ˜í”Œ ë°ì´í„°

---

## ì§„í–‰ ìƒíƒœ ì¶”ì 

| Phase | ìƒíƒœ | ì‹œì‘ì¼ | ì™„ë£Œì¼ |
|-------|------|--------|--------|
| Phase 1: ê³µí†µ ëª¨ë“ˆ | â¬œ ëŒ€ê¸° | - | - |
| Phase 2: ìƒì  | â¬œ ëŒ€ê¸° | - | - |
| Phase 3: ìŠ¤í…Œì´ì§€ ì§„ì… | â¬œ ëŒ€ê¸° | - | - |
| Phase 4: ë¼ì´ë¸Œ ì´ë²¤íŠ¸ | â¬œ ëŒ€ê¸° | - | - |
| Phase 5: ê¸°ì¡´ ê°•í™” | â¬œ ëŒ€ê¸° | - | - |

---

## ê´€ë ¨ ë¬¸ì„œ

- [PROGRESS.md](../PROGRESS.md) - ì „ì²´ ì§„í–‰ìƒí™©
- [ARCHITECTURE.md](../ARCHITECTURE.md) - ì•„í‚¤í…ì²˜ ê°œìš”
- [CONVENTIONS.md](../CONVENTIONS.md) - ì½”ë”© ê·œì¹™
- [DOC_RULES.md](../DOC_RULES.md) - ë¬¸ì„œ ì‘ì„± ê·œì¹™

### Phaseë³„ ìƒì„¸ ìŠ¤í™
- [Phase 1: Reward.md](../Specs/Common/Reward.md)
- [Phase 2: Shop.md](../Specs/Shop.md)
- [Phase 3: Stage.md](../Specs/Stage.md)
- [Phase 4: LiveEvent.md](../Specs/LiveEvent.md)
